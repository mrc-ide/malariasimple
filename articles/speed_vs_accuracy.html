<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Speed/Accuracy Trade-Off • malariasimple</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Speed/Accuracy Trade-Off">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">malariasimple</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Basic_Model_Run.html">Basic Model Run</a>
    </li>
    <li>
      <a href="../articles/model_introduction.html">Model Introduction</a>
    </li>
    <li>
      <a href="../articles/speed_vs_accuracy.html">Speed/Accuracy Trade-Off</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Speed/Accuracy Trade-Off</h1>
            
      

      <div class="hidden name"><code>speed_vs_accuracy.Rmd</code></div>

    </div>

    
    
<p><em>malariasimple</em> is a time-discrete, compartmental model. This
means that the model does not use ODEs, but rather approximates them
using difference equations at small time-steps. In addition, all
populations are modelled as compartments and not individually. These
factors allow significant speed gains in the model, however they are
approximations and outputs can deviate from more mathematically exact
solutions. <em>malariasimple</em> contains several tuneable parameters
which can be altered to improve model speed (often at the expense of
mathematical accuracy) and vice versa depending on the requirements of
the user. Tuneable parameters are:</p>
<ul>
<li>tsd (time steps per day)</li>
<li>het_brackets (Number of biting heterogeneity compartments)</li>
<li>lag_rates (sub-compartments approximating the delay in FOI)</li>
<li>age_vector (No. of age compartments)</li>
</ul>
<p>Some parameter trade-offs are more efficient than others. In this
vignette, we will demonstrate some recommended parameter
combinations.</p>
<p><strong>TL;DR</strong></p>
<ul>
<li>For most use cases, the default values are fine</li>
<li>Optimising the age_vector is less obvious. In general, you want to
increase resolution within age-ranges of interest, but avoid having too
much difference in category widths</li>
<li>If in doubt, check against <em>malariasimulation</em>.</li>
</ul>
<div class="section level2">
<h2 id="non-age-trade-offs">Non-age trade-offs<a class="anchor" aria-label="anchor" href="#non-age-trade-offs"></a>
</h2>
<p>To compare the efficiency of non-age_vector parameter values, we ran
each combination of parameter values from:</p>
<ul>
<li>tsd 2:7</li>
<li>het_brackets 1:7</li>
<li>lag_rates 1:10</li>
</ul>
<p>Accuracy is measured as root mean squared error (RMSE) from the
average of two equivalent <em>malariasimulation</em> runs with
population = 5,000,000. Runtime is the average of 10 identical
<em>malariasimple</em> simulations. The example simulation included both
ITN and SMC, and was run for 1000 days.</p>
<p><img src="images%2Fint_other_groups_vs_speed.png" width="110%"><img src="images%2Fint_other_groups_vs_rmse_2_10.png" width="110%"><em>Some takeaways</em></p>
<ul>
<li>lag_rates make a small difference to accuracy, but are very cheap -
so you may as well have 10</li>
<li>Accuracy increases significantly for both tsd and het_brackets up to
3. After that, returns are minimal.</li>
</ul>
<div class="section level4">
<h4 id="pareto-optimal-combinations">Pareto Optimal Combinations<a class="anchor" aria-label="anchor" href="#pareto-optimal-combinations"></a>
</h4>
<p>Speed/Accuracy for each parameter combination is plotted below.
Pareto optimal solutions are shown in red. Specific parameter
combinations are given in the format [tsd, het_brackets, lag_rates].</p>
<p><img src="images%2Fint_pareto_2_10.png" width="110%"></p>
<p>For reference, this is what these RMSEs look like
<img src="images%2Fint_accuracy_demo.png" width="110%"> (The above
simulations used [ages_under_2, ages_2_10, ages_over_10] = [2, 6,
4])</p>
</div>
</div>
<div class="section level2">
<h2 id="age_vector-trade-offs">age_vector trade-offs<a class="anchor" aria-label="anchor" href="#age_vector-trade-offs"></a>
</h2>
<p>The age_vector parameter details how many age categories the human
population is divided into, as well as the size of each category.
Optimising this parameter is slightly more complex and depends on
depends on what you are trying to fit to.</p>
<p>As a general rule, there is an added trade-off between:</p>
<ul>
<li>Maximising the number of age groups within the output age-range you
are interested in</li>
<li>Minimising differences in the age group sizes.</li>
</ul>
<p>In this example define age factor by</p>
<ul>
<li>number of ages categories under 2 (ages_under_2)</li>
<li>number of age categories between 2 and 10 (ages_2_10)</li>
<li>number of age categories between 10 and 100 (ages_over_10)</li>
</ul>
<p>using the following function</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">get_age_vector</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ages_under_2</span> <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                           <span class="va">ages_2_10</span> <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                           <span class="va">ages_over_10</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ages1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span> <span class="op">*</span> <span class="fl">365</span>, length.out <span class="op">=</span> <span class="va">ages_under_2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">ages2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">365</span>, <span class="fl">10</span> <span class="op">*</span> <span class="fl">365</span>, length.out <span class="op">=</span> <span class="va">ages_2_10</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">ages3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">*</span> <span class="fl">365</span>, <span class="fl">100</span> <span class="op">*</span> <span class="fl">365</span>, length.out <span class="op">=</span> <span class="va">ages_over_10</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">age_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ages1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">ages_under_2</span><span class="op">]</span>, <span class="va">ages2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">ages_2_10</span><span class="op">]</span>, <span class="va">ages3</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">ages_over_10</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">age_vector</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="images%2Fint_age_groups_vs_speed.png" width="110%"><img src="images%2Fint_age_groups_vs_rmse_2_10.png" width="110%"><img src="images%2Fint_age_groups_vs_rmse_0_100.png" width="110%"></p>
<p><img src="images%2Fint_age_pareto_2_10.png" width="110%"><img src="images%2Fint_age_pareto_0_100.png" width="110%"></p>
<p><img src="images%2Fage_accuracy_demo_210.png" width="110%"><img src="images%2Fage_accuracy_demo_0100.png" width="110%">
(The above simulations used [tsd, het_brackets, lag_rates] = [3, 4,
4])</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Debbie Shackleton, Peter Winskill.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
