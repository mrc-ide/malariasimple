<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Model Run • malariasimple</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic Model Run">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">malariasimple</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Basic_Model_Run.html">Basic Model Run</a>
    </li>
    <li>
      <a href="../articles/model_introduction.html">Model Introduction</a>
    </li>
    <li>
      <a href="../articles/speed_vs_accuracy.html">Speed/Accuracy Trade-Off</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic Model Run</h1>
            
      

      <div class="hidden name"><code>Basic_Model_Run.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="simplest-run">1. Simplest run<a class="anchor" aria-label="anchor" href="#simplest-run"></a>
</h2>
<p>We can get started with the simplest model run with almost entirely
default model parameters. The only parameter that malariasimple requires
you to define in the initial EIR (init_EIR)</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">malariasimple</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Define default parameters</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_parameters.html">get_parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_equilibrium.html">set_equilibrium</a></span><span class="op">(</span>init_EIR <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Run model</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot PfPR[2-10]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">time</span>, y <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">n_detect_730_3650</span><span class="op">/</span><span class="va">out</span><span class="op">$</span><span class="va">n_730_3650</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Days"</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">Pf</span><span class="op">)</span>,<span class="st">"PR"</span><span class="op">[</span><span class="fl">2</span><span class="op">-</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Basic_Model_Run_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="setting-up-basic-parameters">2. Setting up basic parameters<a class="anchor" aria-label="anchor" href="#setting-up-basic-parameters"></a>
</h2>
<p>Simulating a a model in <em>malariasimple</em> is a two-step process:
first define parameters, then run the model. You can define all core
parameters using the helper function <code><a href="../reference/get_parameters.html">get_parameters()</a></code>. For
a detailed description of the parameters and their default values, refer
to the documentation by running <code><a href="../reference/get_parameters.html">?get_parameters</a></code>.</p>
<p>The other key function in preparing parameters is
<code>set_equilbrium()</code>. This calculates equilibrium parameters at
the specified initial EIR. This function also provides some ‘finishing
touches’ to the parameter list in order to satisfy the model. It is
therefore essential that <code>set_equilbrium()</code> is called at the
end of the parameter preparing process.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custom_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_parameters.html">get_parameters</a></span><span class="op">(</span>n_days <span class="op">=</span> <span class="fl">200</span>, <span class="co">#Length of simulation</span></span>
<span>                                ft <span class="op">=</span> <span class="fl">0.3</span>, <span class="co">#Proportion treated</span></span>
<span>                                eta <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">30</span><span class="op">*</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co">#Human population birth/death rate</span></span>
<span>  <span class="fu"><a href="../reference/set_equilibrium.html">set_equilibrium</a></span><span class="op">(</span>init_EIR <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">custom_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span><span class="va">custom_params</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="age-group-rendering">Age Group Rendering<a class="anchor" aria-label="anchor" href="#age-group-rendering"></a>
</h4>
<p>From <code><a href="../reference/get_parameters.html">get_parameters()</a></code>, we can define which age groups we
want the model to output regarding clinical incidence and prevalence. It
is essential that these align with the age compartments defined in
age_vector (for default values, see ?get_parameters). All ages must be
provided in <em>days</em>. To align with <code>malariasimulation</code>,
prevalence is inferred from the proportion of detected infections
(n_detect_) and the population proportion within that age group (n_)</p>
<p>In the following examples we will request prevalence and clinical
incidence for two age groups:</p>
<ul>
<li>Ages 2-10</li>
<li>Everyone</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Define age categories</span></span>
<span><span class="va">age_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">100</span><span class="op">)</span><span class="op">*</span><span class="fl">365</span></span>
<span><span class="va">min_age_render</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fl">365</span></span>
<span><span class="va">max_age_render</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="cn">Inf</span><span class="op">)</span><span class="op">*</span><span class="fl">365</span></span>
<span></span>
<span><span class="co">## Set up model parameters</span></span>
<span><span class="va">params_ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_parameters.html">get_parameters</a></span><span class="op">(</span>n_days <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                              age_vector <span class="op">=</span> <span class="va">age_vector</span>,</span>
<span>                              clin_inc_rendering_min_ages <span class="op">=</span> <span class="va">min_age_render</span>,</span>
<span>                              clin_inc_rendering_max_ages <span class="op">=</span> <span class="va">max_age_render</span>,</span>
<span>                              prevalence_rendering_min_ages <span class="op">=</span> <span class="va">min_age_render</span>,</span>
<span>                              prevalence_rendering_max_ages <span class="op">=</span> <span class="va">max_age_render</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_equilibrium.html">set_equilibrium</a></span><span class="op">(</span>init_EIR <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Run model</span></span>
<span><span class="va">out_ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span><span class="va">params_ages</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">out_ages</span><span class="op">$</span><span class="va">time</span>, y <span class="op">=</span> <span class="va">out_ages</span><span class="op">$</span><span class="va">n_clin_inc_0_Inf</span> <span class="op">/</span> <span class="va">out_ages</span><span class="op">$</span><span class="va">n_0_Inf</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"#F8766D"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.0025</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Days"</span>, ylab <span class="op">=</span> <span class="st">"Clinical Incidence"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">out_ages</span><span class="op">$</span><span class="va">time</span>, <span class="va">out_ages</span><span class="op">$</span><span class="va">n_clin_inc_730_3650</span> <span class="op">/</span> <span class="va">out_ages</span><span class="op">$</span><span class="va">n_730_3650</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"#00BFC4"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"All ages"</span>, <span class="st">"Ages 2-10"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#F8766D"</span>, <span class="st">"#00BFC4"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span>, ncol <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_ages</span><span class="op">$</span><span class="va">time</span>, <span class="va">out_ages</span><span class="op">$</span><span class="va">n_detect_0_Inf</span> <span class="op">/</span> <span class="va">out_ages</span><span class="op">$</span><span class="va">n_0_Inf</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"#F8766D"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.4</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Days"</span>, ylab <span class="op">=</span> <span class="st">"Prevalence"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">out_ages</span><span class="op">$</span><span class="va">time</span>, <span class="va">out_ages</span><span class="op">$</span><span class="va">n_detect_730_3650</span> <span class="op">/</span> <span class="va">out_ages</span><span class="op">$</span><span class="va">n_730_3650</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"#00BFC4"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"All ages"</span>, <span class="st">"Ages 2-10"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#F8766D"</span>, <span class="st">"#00BFC4"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span>, ncol <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Basic_Model_Run_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="introducing-seasonality">3. Introducing seasonality<a class="anchor" aria-label="anchor" href="#introducing-seasonality"></a>
</h2>
<p>Seasonality can be included in the model using the
<code><a href="../reference/set_seasonality.html">set_seasonality()</a></code> function. The main argument is the
coefficients of a Fourier function (FF) describing the relative carrying
capacity of the vector population over time. In this example, we will
use default parameters for Thies, Senegal using the <a href="https://mrc-ide.github.io/deterministic-malaria-model/index" class="external-link">ICDMM
package</a>. FF coefficients can also be input manually.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##------------------ Define seasonal parameters --------------------</span></span>
<span><span class="co"># admin2 &lt;- "Thies" #Define admin2 region</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># #Import dataframe of FF coefficients for all regions within the ICDMM database</span></span>
<span><span class="co"># ff_df &lt;- ICDMM::load_file("admin_units_seasonal.rds")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># #Find row defining Thies</span></span>
<span><span class="co"># admin_row_index &lt;- ICDMM::admin_match(admin_unit = admin2, admin_units_seasonal = ff_df)</span></span>
<span><span class="co"># admin_row &lt;- ff_df[admin_row_index,]</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># #Put into format required by malariasimple</span></span>
<span><span class="co"># ff_coeffs &lt;- list(g0 = admin_row["a0"],</span></span>
<span><span class="co">#                   g = admin_row[c("a1","a2","a3")],</span></span>
<span><span class="co">#                   h = admin_row[c("b1","b2","b3")],</span></span>
<span><span class="co">#                   theta_c = admin_row["theta_c"])</span></span>
<span><span class="va">ff_coeffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  g0 <span class="op">=</span> <span class="fl">0.28</span>,</span>
<span>  g <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.03</span>, <span class="fl">0.17</span><span class="op">)</span>,</span>
<span>  h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.35</span>, <span class="fl">0.33</span>, <span class="op">-</span><span class="fl">0.08</span><span class="op">)</span>,</span>
<span>  theta_c <span class="op">=</span> <span class="fl">0.28</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Floor argument defines minimal value of relative carrying capacity</span></span>
<span><span class="va">seasonal_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_parameters.html">get_parameters</a></span><span class="op">(</span>n_days <span class="op">=</span> <span class="fl">365</span>,</span>
<span>                                  age_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span><span class="op">)</span><span class="op">*</span><span class="fl">365</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_seasonality.html">set_seasonality</a></span><span class="op">(</span><span class="va">ff_coeffs</span>, floor <span class="op">=</span> <span class="fl">0.002</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_equilibrium.html">set_equilibrium</a></span><span class="op">(</span>init_EIR <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##------------------- Run simulation and plot ---------------------</span></span>
<span><span class="va">seasonal_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span><span class="va">seasonal_params</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">seasonal_output</span><span class="op">$</span><span class="va">time</span>, <span class="va">seasonal_output</span><span class="op">$</span><span class="va">mv</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Days"</span>, <span class="st">"ylab"</span> <span class="op">=</span> <span class="st">"Mosquito Population"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Basic_Model_Run_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>We can also view the relative carrying capacity (known in the model
as ‘theta2’) directly using the <code><a href="../reference/get_seasonal_forcing.html">get_seasonal_forcing()</a></code>
function</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_seasonal_forcing.html">get_seasonal_forcing</a></span><span class="op">(</span><span class="va">ff_coeffs</span>, n_days <span class="op">=</span> <span class="fl">365</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">theta2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Days"</span>, ylab <span class="op">=</span> <span class="st">"theta2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Basic_Model_Run_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Debbie Shackleton, Peter Winskill.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
